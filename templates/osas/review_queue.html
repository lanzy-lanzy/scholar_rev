{% extends 'base/base.html' %}
{% load static %}

{% block title %}Review Queue - OSAS Dashboard{% endblock %}

{% block extra_css %}
<style>
    /* Modern Table Styles */
    .modern-table {
        width: 100%;
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    .modern-table thead {
        background: linear-gradient(135deg, #0e7490 0%, #0891b2 100%);
        color: white;
    }
    
    .modern-table th {
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .modern-table tbody tr {
        border-bottom: 1px solid #e5e7eb;
        transition: all 0.2s;
    }
    
    .modern-table tbody tr:hover {
        background: #f9fafb;
        transform: scale(1.01);
    }
    
    .modern-table td {
        padding: 1rem;
        font-size: 0.875rem;
    }
    
    /* Card Styles */
    .queue-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        overflow: hidden;
        transition: all 0.3s ease;
        border-left: 4px solid var(--accent-warm);
    }
    
    .queue-card:hover {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        transform: translateY(-2px);
    }
    
    .page-header {
        background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-medium) 100%);
        color: white;
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    .filter-section {
        background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-medium) 100%);
        color: white;
        padding: 1.5rem;
        border-radius: 16px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    .filter-label {
        color: white;
        font-weight: 600;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 0.5rem;
    }
    
    .status-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.375rem 0.875rem;
        border-radius: 9999px;
        font-weight: 600;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .badge-pending {
        background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
        color: #92400E;
    }
    
    .badge-under-review {
        background: linear-gradient(135deg, #DBEAFE 0%, #BFDBFE 100%);
        color: #1E40AF;
    }
    
    .view-toggle {
        display: inline-flex;
        background: white;
        border-radius: 8px;
        padding: 4px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .view-toggle-btn {
        padding: 0.5rem 1rem;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.875rem;
        transition: all 0.2s;
        cursor: pointer;
        border: none;
        background: transparent;
    }
    
    .view-toggle-btn.active {
        background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-medium) 100%);
        color: white;
    }
    
    .view-toggle-btn:not(.active) {
        color: var(--primary-medium);
    }
    
    .view-toggle-btn:not(.active):hover {
        color: var(--primary-dark);
        background: var(--neutral-light);
    }
    
    .list-view-item {
        background: white;
        border-radius: 12px;
        padding: 1rem 1.5rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        border-left: 4px solid var(--accent-warm);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
    }
    
    .list-view-item:hover {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transform: translateX(4px);
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" style="background: linear-gradient(to bottom, #f9fafb 0%, var(--neutral-light) 100%); min-height: 100vh;">
    <!-- Header -->
    <div class="mb-8">
        <div class="page-header">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold">Review Queue</h1>
                    <p class="mt-2 text-sm opacity-90">Manage scholarship application reviews</p>
                </div>
                <div class="flex items-center gap-4">
                    <!-- View Toggle -->
                    <div class="view-toggle">
                        <button type="button" class="view-toggle-btn active" id="cardViewBtn" onclick="switchView('card')">
                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                            </svg>
                            Cards
                        </button>
                        <button type="button" class="view-toggle-btn" id="tableViewBtn" onclick="switchView('table')">
                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                            </svg>
                            Table
                        </button>
                        <button type="button" class="view-toggle-btn" id="listViewBtn" onclick="switchView('list')">
                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                            List
                        </button>
                    </div>
                    
                    <button type="button" class="btn-secondary px-6 py-3"
                            onclick="location.reload()">
                        <svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        Refresh Queue
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <div class="filter-section mb-6">
        <h3 class="text-lg font-bold mb-4">Filters</h3>
        <div>
            <form method="GET" class="grid grid-cols-1 gap-4 sm:grid-cols-4 items-end">
                <!-- Status Filter -->
                <div>
                    <label for="status" class="filter-label">Status</label>
                    <select name="status" id="status" 
                            class="w-full px-4 py-3 border-2 border-white rounded-lg focus:outline-none transition-all"
                            style="color: var(--primary-dark);">
                        <option value="">All Statuses</option>
                        <option value="pending" {% if request.GET.status == 'pending' %}selected{% endif %}>Pending Review</option>
                        <option value="under_review" {% if request.GET.status == 'under_review' %}selected{% endif %}>Under Review</option>
                        <option value="additional_info_required" {% if request.GET.status == 'additional_info_required' %}selected{% endif %}>Additional Info Required</option>
                    </select>
                </div>

                <!-- Scholarship Filter -->
                <div>
                    <label for="scholarship" class="filter-label">Scholarship</label>
                    <select name="scholarship" id="scholarship" 
                            class="w-full px-4 py-3 border-2 border-white rounded-lg focus:outline-none transition-all"
                            style="color: var(--primary-dark);">
                        <option value="">All Scholarships</option>
                        {% for scholarship in scholarships %}
                            <option value="{{ scholarship.id }}" {% if request.GET.scholarship == scholarship.id|stringformat:'s' %}selected{% endif %}>{{ scholarship.title }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Priority Filter -->
                <div>
                    <label for="priority" class="filter-label">Priority</label>
                    <select name="priority" id="priority" 
                            class="w-full px-4 py-3 border-2 border-white rounded-lg focus:outline-none transition-all"
                            style="color: var(--primary-dark);">
                        <option value="">All Priorities</option>
                        <option value="high" {% if request.GET.priority == 'high' %}selected{% endif %}>High Priority</option>
                        <option value="medium" {% if request.GET.priority == 'medium' %}selected{% endif %}>Medium Priority</option>
                        <option value="low" {% if request.GET.priority == 'low' %}selected{% endif %}>Low Priority</option>
                    </select>
                </div>

                <!-- Submit Button -->
                <div>
                    <button type="submit" class="btn-secondary w-full px-6 py-3">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                        </svg>
                        Apply Filters
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Applications List -->
    <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
        <div class="px-6 py-4" style="background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-medium) 100%);">
            <h3 class="text-lg font-bold text-white">
                Applications ({{ applications.count }} total)
            </h3>
        </div>
        
        {% if applications %}
            <!-- Card View -->
            <div id="cardView" class="p-4 space-y-4">
                {% for application in applications %}
                    <div class="queue-card">
                        <div class="p-6">
                            <div class="flex items-start justify-between gap-4">
                                <div class="flex-1">
                                    <div class="flex items-center gap-3 mb-2">
                                        <h3 class="text-xl font-bold" style="color: var(--primary-dark);">
                                            {{ application.student.get_full_name|default:application.student.username }}
                                        </h3>
                                        {% if application.status == 'pending' %}
                                            <span class="status-badge badge-pending">
                                                <span class="w-2 h-2 bg-yellow-500 rounded-full mr-2 animate-pulse"></span>
                                                Pending
                                            </span>
                                        {% elif application.status == 'under_review' %}
                                            <span class="status-badge badge-under-review">
                                                <span class="w-2 h-2 bg-blue-500 rounded-full mr-2 animate-pulse"></span>
                                                Under Review
                                            </span>
                                        {% elif application.status == 'osas_approved' %}
                                            <span class="status-badge" style="background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%); color: #065F46;">
                                                <span class="w-2 h-2 bg-teal-500 rounded-full mr-2"></span>
                                                Recommended ✓
                                            </span>
                                        {% elif application.status == 'osas_rejected' %}
                                            <span class="status-badge" style="background: linear-gradient(135deg, #E9D5FF 0%, #D8B4FE 100%); color: #6B21A8;">
                                                <span class="w-2 h-2 bg-purple-500 rounded-full mr-2"></span>
                                                Recommended ✗
                                            </span>
                                        {% endif %}
                                    </div>
                                    <p class="text-sm font-semibold mb-3" style="color: var(--accent-warm);">
                                        {{ application.scholarship.title }}
                                    </p>
                                    <div class="flex flex-wrap gap-4 text-sm" style="color: var(--primary-medium);">
                                        <span class="flex items-center">
                                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                            </svg>
                                            {{ application.submitted_at|date:"M d, Y" }}
                                        </span>
                                        {% if application.gpa %}
                                            <span class="flex items-center">
                                                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                                                </svg>
                                                <strong>GPA:</strong>&nbsp;{{ application.gpa }}
                                            </span>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <!-- Priority Badge -->
                                    {% if application.priority == 'high' %}
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300">
                                            High Priority
                                        </span>
                                    {% elif application.priority == 'medium' %}
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300">
                                            Medium Priority
                                        </span>
                                    {% else %}
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300">
                                            Low Priority
                                        </span>
                                    {% endif %}

                                    <div class="flex flex-col gap-2">
                                        {% if application.status == 'pending' %}
                                            <!-- Assign to Self Button -->
                                            <form method="POST" action="{% url 'core:assign_application' application.id %}">
                                                {% csrf_token %}
                                                <button type="submit" class="btn-success px-4 py-2 text-sm">
                                                    <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                                    </svg>
                                                    Assign to Me
                                                </button>
                                            </form>
                                        {% endif %}

                                        <!-- Review Button -->
                                        <a href="{% url 'core:review_application' application.id %}" 
                                           class="{% if application.status == 'osas_approved' or application.status == 'osas_rejected' %}btn-outline{% else %}btn-secondary{% endif %} px-6 py-2 text-sm inline-flex items-center justify-center">
                                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                            </svg>
                                            {% if application.status == 'osas_approved' or application.status == 'osas_rejected' %}
                                                View Details
                                            {% else %}
                                                Review
                                            {% endif %}
                                            Review
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <!-- List View -->
            <div id="listView" class="p-4 space-y-2" style="display: none;">
                {% for application in applications %}
                    <div class="list-view-item">
                        <div class="flex-1 flex items-center gap-4">
                            <div class="flex-1">
                                <h4 class="text-sm font-bold" style="color: var(--primary-dark);">
                                    {{ application.student.get_full_name|default:application.student.username }}
                                </h4>
                                <p class="text-xs" style="color: var(--accent-warm);">{{ application.scholarship.title }}</p>
                            </div>
                            <div class="text-xs" style="color: var(--primary-medium);">
                                {% if application.gpa %}<strong>GPA:</strong> {{ application.gpa }}{% endif %}
                            </div>
                            <div class="text-xs" style="color: var(--primary-medium);">
                                {{ application.submitted_at|date:"M d, Y" }}
                            </div>
                            <div>
                                {% if application.status == 'pending' %}
                                    <span class="status-badge badge-pending">
                                        <span class="w-2 h-2 bg-yellow-500 rounded-full mr-2 animate-pulse"></span>
                                        Pending
                                    </span>
                                {% elif application.status == 'under_review' %}
                                    <span class="status-badge badge-under-review">
                                        <span class="w-2 h-2 bg-blue-500 rounded-full mr-2 animate-pulse"></span>
                                        Under Review
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            {% if application.status == 'pending' %}
                                <form method="POST" action="{% url 'core:assign_application' application.id %}">
                                    {% csrf_token %}
                                    <button type="submit" class="btn-success px-3 py-1 text-xs">
                                        Assign
                                    </button>
                                </form>
                            {% endif %}
                            <a href="{% url 'core:review_application' application.id %}" 
                               class="btn-secondary px-4 py-1 text-xs">
                                Review
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <!-- Table View -->
            <div id="tableView" class="p-4" style="display: none;">
                <div class="modern-table-container" style="overflow-x: auto; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
                    <table class="modern-table" style="width: 100%; background: white; border-collapse: separate; border-spacing: 0;">
                        <thead style="background: linear-gradient(135deg, #0e7490 0%, #0891b2 100%); color: white;">
                            <tr>
                                <th style="padding: 1rem; text-align: left; font-weight: 600; font-size: 0.875rem; text-transform: uppercase;">Student</th>
                                <th style="padding: 1rem; text-align: left; font-weight: 600; font-size: 0.875rem; text-transform: uppercase;">Scholarship</th>
                                <th style="padding: 1rem; text-align: left; font-weight: 600; font-size: 0.875rem; text-transform: uppercase;">GPA</th>
                                <th style="padding: 1rem; text-align: left; font-weight: 600; font-size: 0.875rem; text-transform: uppercase;">Submitted</th>
                                <th style="padding: 1rem; text-align: left; font-weight: 600; font-size: 0.875rem; text-transform: uppercase;">Status</th>
                                <th style="padding: 1rem; text-align: left; font-weight: 600; font-size: 0.875rem; text-transform: uppercase;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for application in applications %}
                            <tr style="border-bottom: 1px solid #e5e7eb; transition: all 0.2s;" onmouseover="this.style.background='#f9fafb'" onmouseout="this.style.background='white'">
                                <td style="padding: 1rem; font-size: 0.875rem;">
                                    <div class="flex items-center">
                                        <div style="width: 2.5rem; height: 2.5rem; border-radius: 9999px; background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin-right: 0.75rem;">
                                            {{ application.student.first_name.0 }}{{ application.student.last_name.0 }}
                                        </div>
                                        <div>
                                            <div style="font-weight: 600; color: #111827;">{{ application.student.get_full_name }}</div>
                                            <div style="font-size: 0.75rem; color: #6b7280;">{{ application.student.email }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 1rem; font-size: 0.875rem;">
                                    <div style="font-weight: 500; color: #111827;">{{ application.scholarship.title|truncatewords:5 }}</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">${{ application.scholarship.award_amount|floatformat:0 }}</div>
                                </td>
                                <td style="padding: 1rem; font-size: 0.875rem;">
                                    <span style="font-weight: 600; color: #0891b2;">{{ application.gpa }}</span>
                                </td>
                                <td style="padding: 1rem; font-size: 0.875rem;">
                                    <div style="color: #111827;">{{ application.submitted_at|date:"M d, Y" }}</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">{{ application.submitted_at|timesince }} ago</div>
                                </td>
                                <td style="padding: 1rem; font-size: 0.875rem;">
                                    {% if application.status == 'pending' %}
                                        <span class="status-badge badge-pending">Pending</span>
                                    {% elif application.status == 'under_review' %}
                                        <span class="status-badge badge-under-review">Under Review</span>
                                    {% endif %}
                                </td>
                                <td style="padding: 1rem; font-size: 0.875rem;">
                                    <div class="flex gap-2">
                                        {% if application.status == 'pending' %}
                                            <form method="POST" action="{% url 'core:assign_application' application.id %}" class="inline">
                                                {% csrf_token %}
                                                <button type="submit" class="btn-success btn-xs">Assign</button>
                                            </form>
                                        {% endif %}
                                        <a href="{% url 'core:review_application' application.id %}" class="btn-secondary btn-xs">Review</a>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination -->
            {% if applications.has_other_pages %}
                <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700">
                    <nav class="flex items-center justify-between">
                        <div class="flex-1 flex justify-between sm:hidden">
                            {% if applications.has_previous %}
                                <a href="?page={{ applications.previous_page_number }}" class="btn-sm btn-outline">Previous</a>
                            {% endif %}
                            {% if applications.has_next %}
                                <a href="?page={{ applications.next_page_number }}" class="btn-sm btn-outline">Next</a>
                            {% endif %}
                        </div>
                        <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                            <div>
                                <p class="text-sm text-gray-700 dark:text-gray-300">
                                    Showing <span class="font-medium">{{ applications.start_index }}</span> to <span class="font-medium">{{ applications.end_index }}</span> of <span class="font-medium">{{ applications.paginator.count }}</span> results
                                </p>
                            </div>
                            <div>
                                <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                                    {% if applications.has_previous %}
                                        <a href="?page={{ applications.previous_page_number }}" class="btn-sm btn-outline">Previous</a>
                                    {% endif %}
                                    
                                    {% for num in applications.paginator.page_range %}
                                        {% if applications.number == num %}
                                            <span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-indigo-50 text-sm font-medium text-indigo-600">{{ num }}</span>
                                        {% else %}
                                            <a href="?page={{ num }}" class="btn-sm btn-outline">{{ num }}</a>
                                        {% endif %}
                                    {% endfor %}
                                    
                                    {% if applications.has_next %}
                                        <a href="?page={{ applications.next_page_number }}" class="btn-sm btn-outline">Next</a>
                                    {% endif %}
                                </nav>
                            </div>
                        </div>
                    </nav>
                </div>
            {% endif %}
        {% else %}
            <div class="px-6 py-16 text-center">
                <svg class="mx-auto h-20 w-20 opacity-30" style="color: var(--accent-warm);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                <h3 class="mt-4 text-lg font-bold" style="color: var(--primary-dark);">No applications found</h3>
                <p class="mt-2 text-sm" style="color: var(--primary-medium);">
                    There are no applications matching your current filters.
                </p>
            </div>
        {% endif %}
    </div>
</div>

<script>
function switchView(viewType) {
    const cardView = document.getElementById('cardView');
    const listView = document.getElementById('listView');
    const tableView = document.getElementById('tableView');
    const cardBtn = document.getElementById('cardViewBtn');
    const listBtn = document.getElementById('listViewBtn');
    const tableBtn = document.getElementById('tableViewBtn');
    
    // Hide all views
    if (cardView) cardView.style.display = 'none';
    if (listView) listView.style.display = 'none';
    if (tableView) tableView.style.display = 'none';
    
    // Remove active class from all buttons
    if (cardBtn) cardBtn.classList.remove('active');
    if (listBtn) listBtn.classList.remove('active');
    if (tableBtn) tableBtn.classList.remove('active');
    
    // Show selected view and activate button
    if (viewType === 'card') {
        if (cardView) cardView.style.display = 'block';
        if (cardBtn) cardBtn.classList.add('active');
    } else if (viewType === 'table') {
        if (tableView) tableView.style.display = 'block';
        if (tableBtn) tableBtn.classList.add('active');
    } else {
        if (listView) listView.style.display = 'block';
        if (listBtn) listBtn.classList.add('active');
    }
    
    localStorage.setItem('reviewQueueView', viewType);
}

// Load saved view preference on page load
document.addEventListener('DOMContentLoaded', function() {
    const savedView = localStorage.getItem('reviewQueueView') || 'card';
    switchView(savedView);
});
</script>
{% endblock %}